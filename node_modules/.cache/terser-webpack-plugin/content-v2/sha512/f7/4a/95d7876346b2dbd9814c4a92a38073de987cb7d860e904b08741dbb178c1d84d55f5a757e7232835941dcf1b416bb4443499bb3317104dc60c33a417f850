{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-32b1e12e\"],{\"345e\":function(t,e,n){\"use strict\";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"qamember-wrapper\"},[n(\"div\",[n(\"a-select\",{staticStyle:{width:\"150px\",\"margin-left\":\"5px\"},attrs:{\"default-value\":\"全部业务线\"}},t._l(t.qadata_groups,(function(e){return n(\"a-select-option\",{key:e.groupId,attrs:{value:e.groupName},on:{click:function(n){return t.setgroupid(e.groupId)}}},[t._v(\" \"+t._s(e.groupName)+\" \")])})),1),n(\"a-select\",{staticStyle:{width:\"150px\",\"margin-left\":\"20px\"},attrs:{\"default-value\":\"全部项目\"}},t._l(t.qadata_projects,(function(e){return n(\"a-select-option\",{key:e.projectId,attrs:{value:e.projectName},on:{click:function(n){return t.setprojectid(e.projectId)}}},[t._v(\" \"+t._s(e.projectName)+\" \")])})),1),n(\"a-range-picker\",{staticClass:\"a-range-picker\",staticStyle:{width:\"400px\"},attrs:{\"show-time\":\"\"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:\"dateRange\"}},[n(\"template\",{slot:\"renderExtraFooter\"},[t._v(\" 日期选择\")])],2),n(\"a-button\",{attrs:{type:\"primary\",icon:\"search\"},on:{click:function(e){return t.getdate(t.dateRange)}}},[t._v(\" 查询 \")])],1),n(\"h6\",[t._v(\"（备注：绿色：等于8h，红色：大于8h，黑色：小于8h，橘色：请假，粉色：假期）\")]),n(\"a-table\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{columns:t.all_columns_data,\"data-source\":t.qadata,scroll:{x:t.columns_len},bordered:\"\",pagination:{defaultPageSize:100}},scopedSlots:t._u([{key:\"action\",fn:function(e,a){return n(\"div\",{},[e.tbWorkContent&&e.tbWorkContent.length&&!0===e.line_show?n(\"div\",t._l(e.tbWorkContent,(function(a,o){return n(\"a\",{key:o,on:{click:function(e){return t.jumpto(a&&a.url)}}},[n(\"span\",{staticClass:\"record-text\",staticStyle:{\"margin-top\":\"20px\",\"margin-bottom\":\"20px\"}},[8===e.count?n(\"span\",{staticStyle:{color:\"rgb(106, 168, 79)\"}},[t._v(\"[\"+t._s(a.hour)+\"H]\")]):t._e(),e.count>8?n(\"span\",{staticStyle:{color:\"rgb(205, 51, 51)\"}},[t._v(\"[\"+t._s(a.hour)+\"H]\")]):t._e(),e.count<8?n(\"span\",{staticStyle:{color:\"rgb(0, 0, 0)\"}},[t._v(\"[\"+t._s(a.hour)+\"H]\")]):t._e(),8===e.count?n(\"span\",{staticStyle:{color:\"rgb(106, 168, 79)\"}},[t._v(t._s(a.content))]):e.count>8?n(\"span\",{staticStyle:{color:\"rgb(205, 51, 51)\"}},[t._v(t._s(a.content))]):e.count<8?n(\"span\",{staticStyle:{color:\"rgb(0, 0, 0)\"}},[t._v(t._s(a.content))]):0===a.work_type?n(\"span\",{staticStyle:{color:\"rgb(205, 149, 12)\"}},[t._v(t._s(a.content))]):n(\"span\",{staticStyle:{color:\"rgb(238, 99, 99)\"}},[t._v(t._s(a.content))])]),n(\"br\")])})),0):t._e(),e.line_show?n(\"hr\"):t._e(),n(\"div\",[e.workContents&&e.workContents.length?n(\"div\",t._l(e.workContents,(function(a,o){return n(\"a\",{key:o,on:{click:function(e){return t.jumpto(a&&a.url)}}},[n(\"span\",{staticClass:\"record-text\",staticStyle:{\"margin-top\":\"20px\",\"margin-bottom\":\"20px\"}},[1===a.work_type&&8===e.count&&\"\"!==a.content?n(\"span\",{staticStyle:{color:\"rgb(106, 168, 79)\"}},[t._v(\"[\"+t._s(a.hour)+\"H]\")]):1===a.work_type&&e.count>8&&\"\"!==a.content?n(\"span\",{staticStyle:{color:\"rgb(205, 51, 51)\"}},[t._v(\"[\"+t._s(a.hour)+\"H]\")]):1===a.work_type&&e.count<8&&\"\"!==a.content?n(\"span\",{staticStyle:{color:\"rgb(0, 0, 0)\"}},[t._v(\"[\"+t._s(a.hour)+\"H]\")]):t._e(),1===a.work_type&&8===e.count?n(\"span\",{staticStyle:{color:\"rgb(106, 168, 79)\"}},[t._v(t._s(a.content))]):1===a.work_type&&e.count>8?n(\"span\",{staticStyle:{color:\"rgb(205, 51, 51)\"}},[t._v(t._s(a.content))]):1===a.work_type&&e.count<8?n(\"span\",{staticStyle:{color:\"rgb(0, 0, 0)\"}},[t._v(t._s(a.content))]):0===a.work_type?n(\"span\",{staticStyle:{color:\"rgb(255, 20, 147)\"}},[t._v(t._s(a.content))]):n(\"span\",{staticStyle:{color:\"rgb(255, 127, 0)\"}},[t._v(t._s(a.content))])]),n(\"br\")])})),0):t._e(),n(\"div\",[n(\"div\",{staticStyle:{\"margin-top\":\"10px\"}},[n(\"a-button\",{attrs:{id:\"editbutton\",size:\"small\"},on:{click:function(n){return t.showModal(e.date,e.workContents,a.id)}}},[t._v(\"编辑\")])],1)])])])}}])}),n(\"div\",[n(\"a-modal\",{attrs:{title:\"编辑\",afterClose:t.onClose,width:\"800px\"},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:\"visible\"}},[t._l(t.contenttask,(function(e,a){return n(\"div\",{key:a,staticStyle:{\"margin-top\":\"5px\"}},[n(\"span\",{attrs:{width:\"100px\"}},[t._v(\"工作内容: \"),n(\"a-input\",{staticClass:\"editstyle\",model:{value:e.content,callback:function(n){t.$set(e,\"content\",n)},expression:\"item.content\"}})],1),n(\"span\",[t._v(\"链接地址: \"),n(\"a-input\",{staticClass:\"editstyle\",model:{value:e.url,callback:function(n){t.$set(e,\"url\",n)},expression:\"item.url\"}})],1),n(\"span\",[t._v(\"工时: \"),n(\"a-input\",{staticClass:\"editstyle\",staticStyle:{width:\"50px\"},model:{value:e.hour,callback:function(n){t.$set(e,\"hour\",n)},expression:\"item.hour\"}})],1),n(\"span\",[n(\"a-button\",{staticStyle:{\"margin-left\":\"5px\"},attrs:{type:\"danger\"},on:{click:function(e){return t.deltask(a)}}},[t._v(\"删除\")])],1)])})),n(\"div\",[n(\"span\",[n(\"a-button\",{attrs:{type:\"primary\"},on:{click:function(e){return t.addtask()}}},[t._v(\"新增\")])],1),n(\"span\",[n(\"a-button\",{staticStyle:{\"margin-left\":\"50px\",\"margin-top\":\"10px\"},attrs:{type:\"primary\"},on:{click:function(e){return t.qingjia()}}},[t._v(\"请假\")])],1)])],2)],1)],1)},o=[],s=(n(\"159b\"),n(\"99af\"),n(\"fb6a\"),n(\"a434\"),n(\"c1df\")),r=n.n(s),i=(n(\"5c3a\"),n(\"b775\")),c=(n(\"8111\"),{name:\"qamemberdata\",data:function(){return{qadata_groups:[],qadata_projects:[],qadatas:[],dateRange:[],setprojectId:0,setgroupId:0,all_columns_data:[],columns_len:0,qadata:[],visible:!1,contenttask:[],edittaskdate:\"\",edituserid:\"\"}},methods:{init:function(){this.getproject();var t=this.dayjs().startOf(\"week\").add(1,\"day\"),e=this.dayjs().endOf(\"week\").add(1,\"day\");this.dateRange=[r()(t.format(\"dddd MMM DD YYYY HH:mm:ss ZZ\")),r()(e.format(\"dddd MMM DD YYYY HH:mm:ss ZZ\"))],this.getdate(this.dateRange)},getdate:function(t){var e=[this.dayjs(t[0].valueOf()).format(\"YYYY/MM/DD HH:mm:ss\"),this.dayjs(t[1].valueOf()).format(\"YYYY/MM/DD HH:mm:ss\")];this.get_columns(e),this.getneedtimelist(e)},setgroupid:function(t){var e=this;this.setgroupId=t;var n=[{projectId:0,projectName:\"全部项目\"}];this.qadatas.forEach((function(a){t===a.groupId?e.qadata_projects=n.concat(a.projectList):0===t&&(e.qadata_projects=e.allproject)}))},setprojectid:function(t){this.setprojectId=t},getproject:function(){var t=this;i[\"b\"].get(\"/project/query\").then((function(e){if(200===e.code){t.qadatas=e.data;var n=new Array,a=new Array;n.push({groupId:0,groupName:\"全部业务线\"}),a.push({projectId:0,projectName:\"全部项目\"}),e.data.forEach((function(t){n.push({groupId:t.groupId,groupName:t.groupName}),t.projectList.forEach((function(t){a.push({projectId:t.projectId,projectName:t.projectName})}))})),t.qadata_groups=n,t.qadata_projects=a,t.allproject=a}})).catch((function(e){t.$message.error(\"内网数据获取失败\")}))},getneedtimelist:function(t){var e=this;t[0]=this.dayjs(t[0].valueOf()).format(\"YYYY-MM-DD\"),t[1]=this.dayjs(t[1].valueOf()).format(\"YYYY-MM-DD\"),i[\"b\"].post(\"/DailyWork/query\",{startTime:t[0],endTime:t[1],projectId:this.setprojectId,groupId:this.setgroupId}).then((function(t){200===t.code&&(e.qadata=e.sortdata(t.data))})).catch((function(t){e.$message.error(\"内网数据获取失败\")}))},sortdata:function(t){var e=new Array;return e=this.all_columns_data.slice(2),t.forEach((function(t){for(var n=0;n<e.length;n++)t[e[n].children[0].title]=t.dateWork[n]})),t=this.countdayhours(t),t},countdayhours:function(t){var e=new Array;return e=this.all_columns_data.slice(2),t.forEach((function(t){for(var n=0;n<e.length;n++){var a=0,o=!0;t[e[n].children[0].title].workContents&&0!==t[e[n].children[0].title].workContents.length&&t[e[n].children[0].title].workContents.forEach((function(t){null!==t.hour&&(a+=t.hour),2!==t.work_type&&0!==t.work_type||(o=!1)})),t[e[n].children[0].title].tbWorkContent&&0!==t[e[n].children[0].title].tbWorkContent.length&&t[e[n].children[0].title].tbWorkContent.forEach((function(t){null!==t.hour&&(a+=t.hour)})),t[e[n].children[0].title].workContents&&0===t[e[n].children[0].title].workContents.length&&t[e[n].children[0].title].tbWorkContent&&0===t[e[n].children[0].title].tbWorkContent.length&&(o=!1),t[e[n].children[0].title].count=a,t[e[n].children[0].title].line_show=o}})),t},jumpto:function(t){null!==t&&\"\"!==t&&window.open(t)},showModal:function(t,e,n){this.contenttask=e,this.edittaskdate=t,this.edituserid=n,document.documentElement.style=\"\",0===this.contenttask.length&&(this.contenttask=[{content:\"\",hour:0,url:null,work_type:1}]),this.visible=!0},deltask:function(t){this.contenttask.splice(t,1)},addtask:function(){this.contenttask.push({content:\"\",hour:null,url:null,work_type:1})},handleOk:function(){for(var t=this,e=1,n=0;n<this.contenttask.length;n++)if(\"\"===this.contenttask[n].content||null===this.contenttask[n].hour){this.$message.error(\"内容和工时不能为空\"),e=0;break}1===e&&(this.contenttask.forEach((function(t){t.work_type=1})),i[\"b\"].post(\"/DailyWork/update\",{userId:this.edituserid,date:this.edittaskdate,workContent:this.contenttask}).then((function(e){200===e.code?(t.$message.success(\"提交成功\"),t.visible=!1,t.getdate(t.dateRange)):t.$message.error(\"提交失败\")})).catch((function(e){t.isLoading=!1,t.$message.error(\"内网数据获取失败\")})))},qingjia:function(){var t=this,e={content:\"请假\",hour:0,url:null,work_type:2};i[\"b\"].post(\"/DailyWork/update\",{userId:this.edituserid,date:this.edittaskdate,workContent:[e]}).then((function(e){200===e.code?(t.$message.success(\"提交成功\"),t.visible=!1,t.getdate(t.dateRange)):t.$message.error(\"提交失败\")})).catch((function(e){t.isLoading=!1,t.$message.error(\"内网数据获取失败\")})),this.visible=!1},onClose:function(){document.documentElement.style.overflowY=\"overlay\"},get_columns:function(t){var e=t[0],n=t[1],a=new Array;a.push({title:\"业务线\",key:\"projectName\",dataIndex:\"projectName\",width:30}),a.push({title:\"姓名\",key:\"name\",dataIndex:\"name\",width:30});var o=new Date(e);n=new Date(n);while(o<=n)\"星期六\"===this.get_week(this.dayjs(new Date(o)).day())||\"星期日\"===this.get_week(this.dayjs(new Date(o)).day())?a.push({title:this.get_week(this.dayjs(new Date(o)).day()),children:[{title:this.dayjs(new Date(o)).format(\"YYYY-MM-DD\"),key:this.dayjs(new Date(o)).format(\"YYYY-MM-DD\"),dataIndex:this.dayjs(new Date(o)).format(\"YYYY-MM-DD\"),width:35,scopedSlots:{customRender:\"action\"}}]}):a.push({title:this.get_week(this.dayjs(new Date(o)).day()),children:[{title:this.dayjs(new Date(o)).format(\"YYYY-MM-DD\"),key:this.dayjs(new Date(o)).format(\"YYYY-MM-DD\"),dataIndex:this.dayjs(new Date(o)).format(\"YYYY-MM-DD\"),width:50,scopedSlots:{customRender:\"action\"}}]}),o.setDate(o.getDate()+1);this.columns_len=120*a.length,this.all_columns_data=a},get_week:function(t){var e=new Array(\"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\"),n=e[t];return n}},computed:{},created:function(){this.init()}}),l=c,d=(n(\"5990\"),n(\"2877\")),u=Object(d[\"a\"])(l,a,o,!1,null,\"2391bb8e\",null);e[\"default\"]=u.exports},5990:function(t,e,n){\"use strict\";n(\"91a5\")},\"91a5\":function(t,e,n){}}]);","extractedComments":[]}