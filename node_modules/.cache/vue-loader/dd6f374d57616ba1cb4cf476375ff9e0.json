{"remainingRequest":"/Users/momo/vue/live-data-analysis-static/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/momo/vue/live-data-analysis-static/src/components/MultiTab/MultiTab.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/momo/vue/live-data-analysis-static/src/components/MultiTab/MultiTab.vue","mtime":1626864386255},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/cache-loader/dist/cjs.js","mtime":1626939577620},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/babel-loader/lib/index.js","mtime":1640003217818},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/cache-loader/dist/cjs.js","mtime":1626939577620},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/vue-loader/lib/index.js","mtime":1640003225539}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBldmVudHMgZnJvbSAnLi9ldmVudHMnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ011bHRpVGFiJywKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGZ1bGxQYXRoTGlzdDogW10sCiAgICAgIHBhZ2VzOiBbXSwKICAgICAgYWN0aXZlS2V5OiAnJywKICAgICAgbmV3VGFiSW5kZXg6IDAKICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgLy8gYmluZCBldmVudAogICAgZXZlbnRzLiRvbignb3BlbicsIHZhbCA9PiB7CiAgICAgIGlmICghdmFsKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBtdWx0aS10YWI6IG9wZW4gdGFiICR7dmFsfSBlcnJgKQogICAgICB9CiAgICAgIHRoaXMuYWN0aXZlS2V5ID0gdmFsCiAgICB9KS4kb24oJ2Nsb3NlJywgdmFsID0+IHsKICAgICAgaWYgKCF2YWwpIHsKICAgICAgICB0aGlzLmNsb3NlVGhhdCh0aGlzLmFjdGl2ZUtleSkKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICB0aGlzLmNsb3NlVGhhdCh2YWwpCiAgICB9KS4kb24oJ3JlbmFtZScsICh7IGtleSwgbmFtZSB9KSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdyZW5hbWUnLCBrZXksIG5hbWUpCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMucGFnZXMuZmluZChpdGVtID0+IGl0ZW0ucGF0aCA9PT0ga2V5KQogICAgICAgIGl0ZW0ubWV0YS5jdXN0b21UaXRsZSA9IG5hbWUKICAgICAgICB0aGlzLiRmb3JjZVVwZGF0ZSgpCiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgfQogICAgfSkKCiAgICB0aGlzLnBhZ2VzLnB1c2godGhpcy4kcm91dGUpCiAgICB0aGlzLmZ1bGxQYXRoTGlzdC5wdXNoKHRoaXMuJHJvdXRlLmZ1bGxQYXRoKQogICAgdGhpcy5zZWxlY3RlZExhc3RQYXRoKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIG9uRWRpdCAodGFyZ2V0S2V5LCBhY3Rpb24pIHsKICAgICAgdGhpc1thY3Rpb25dKHRhcmdldEtleSkKICAgIH0sCiAgICByZW1vdmUgKHRhcmdldEtleSkgewogICAgICB0aGlzLnBhZ2VzID0gdGhpcy5wYWdlcy5maWx0ZXIocGFnZSA9PiBwYWdlLmZ1bGxQYXRoICE9PSB0YXJnZXRLZXkpCiAgICAgIHRoaXMuZnVsbFBhdGhMaXN0ID0gdGhpcy5mdWxsUGF0aExpc3QuZmlsdGVyKHBhdGggPT4gcGF0aCAhPT0gdGFyZ2V0S2V5KQogICAgICAvLyDliKTmlq3lvZPliY3moIfnrb7mmK/lkKblhbPpl63vvIzoi6XlhbPpl63liJnot7PovazliLDmnIDlkI7kuIDkuKrov5jlrZjlnKjnmoTmoIfnrb7pobUKICAgICAgaWYgKCF0aGlzLmZ1bGxQYXRoTGlzdC5pbmNsdWRlcyh0aGlzLmFjdGl2ZUtleSkpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkTGFzdFBhdGgoKQogICAgICB9CiAgICB9LAogICAgc2VsZWN0ZWRMYXN0UGF0aCAoKSB7CiAgICAgIHRoaXMuYWN0aXZlS2V5ID0gdGhpcy5mdWxsUGF0aExpc3RbdGhpcy5mdWxsUGF0aExpc3QubGVuZ3RoIC0gMV0KICAgIH0sCgogICAgLy8gY29udGVudCBtZW51CiAgICBjbG9zZVRoYXQgKGUpIHsKICAgICAgLy8g5Yik5pat5piv5ZCm5Li65pyA5ZCO5LiA5Liq5qCH562+6aG177yM5aaC5p6c5piv5pyA5ZCO5LiA5Liq77yM5YiZ5peg5rOV6KKr5YWz6ZetCiAgICAgIGlmICh0aGlzLmZ1bGxQYXRoTGlzdC5sZW5ndGggPiAxKSB7CiAgICAgICAgdGhpcy5yZW1vdmUoZSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+i/meaYr+acgOWQjuS4gOS4quagh+etvuS6hiwg5peg5rOV6KKr5YWz6ZetJykKICAgICAgfQogICAgfSwKICAgIGNsb3NlTGVmdCAoZSkgewogICAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmZ1bGxQYXRoTGlzdC5pbmRleE9mKGUpCiAgICAgIGlmIChjdXJyZW50SW5kZXggPiAwKSB7CiAgICAgICAgdGhpcy5mdWxsUGF0aExpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgIGlmIChpbmRleCA8IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgICB0aGlzLnJlbW92ZShpdGVtKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKCflt6bkvqfmsqHmnInmoIfnrb4nKQogICAgICB9CiAgICB9LAogICAgY2xvc2VSaWdodCAoZSkgewogICAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmZ1bGxQYXRoTGlzdC5pbmRleE9mKGUpCiAgICAgIGlmIChjdXJyZW50SW5kZXggPCAodGhpcy5mdWxsUGF0aExpc3QubGVuZ3RoIC0gMSkpIHsKICAgICAgICB0aGlzLmZ1bGxQYXRoTGlzdC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgaWYgKGluZGV4ID4gY3VycmVudEluZGV4KSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGl0ZW0pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+WPs+S+p+ayoeacieagh+etvicpCiAgICAgIH0KICAgIH0sCiAgICBjbG9zZUFsbCAoZSkgewogICAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmZ1bGxQYXRoTGlzdC5pbmRleE9mKGUpCiAgICAgIHRoaXMuZnVsbFBhdGhMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgaWYgKGluZGV4ICE9PSBjdXJyZW50SW5kZXgpIHsKICAgICAgICAgIHRoaXMucmVtb3ZlKGl0ZW0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGNsb3NlTWVudUNsaWNrIChrZXksIHJvdXRlKSB7CiAgICAgIHRoaXNba2V5XShyb3V0ZSkKICAgIH0sCiAgICByZW5kZXJUYWJQYW5lTWVudSAoZSkgewogICAgICByZXR1cm4gKAogICAgICAgIDxhLW1lbnUgey4uLnsgb246IHsgY2xpY2s6ICh7IGtleSwgaXRlbSwgZG9tRXZlbnQgfSkgPT4geyB0aGlzLmNsb3NlTWVudUNsaWNrKGtleSwgZSkgfSB9IH19PgogICAgICAgICAgPGEtbWVudS1pdGVtIGtleT0iY2xvc2VUaGF0Ij7lhbPpl63lvZPliY3moIfnrb48L2EtbWVudS1pdGVtPgogICAgICAgICAgPGEtbWVudS1pdGVtIGtleT0iY2xvc2VSaWdodCI+5YWz6Zet5Y+z5L6nPC9hLW1lbnUtaXRlbT4KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlTGVmdCI+5YWz6Zet5bem5L6nPC9hLW1lbnUtaXRlbT4KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlQWxsIj7lhbPpl63lhajpg6g8L2EtbWVudS1pdGVtPgogICAgICAgIDwvYS1tZW51PgogICAgICApCiAgICB9LAogICAgLy8gcmVuZGVyCiAgICByZW5kZXJUYWJQYW5lICh0aXRsZSwga2V5UGF0aCkgewogICAgICBjb25zdCBtZW51ID0gdGhpcy5yZW5kZXJUYWJQYW5lTWVudShrZXlQYXRoKQoKICAgICAgcmV0dXJuICgKICAgICAgICA8YS1kcm9wZG93biBvdmVybGF5PXttZW51fSB0cmlnZ2VyPXtbJ2NvbnRleHRtZW51J119PgogICAgICAgICAgPHNwYW4gc3R5bGU9e3sgdXNlclNlbGVjdDogJ25vbmUnIH19PnsgdGl0bGUgfTwvc3Bhbj4KICAgICAgICA8L2EtZHJvcGRvd24+CiAgICAgICkKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAnJHJvdXRlJzogZnVuY3Rpb24gKG5ld1ZhbCkgewogICAgICB0aGlzLmFjdGl2ZUtleSA9IG5ld1ZhbC5mdWxsUGF0aAogICAgICBpZiAodGhpcy5mdWxsUGF0aExpc3QuaW5kZXhPZihuZXdWYWwuZnVsbFBhdGgpIDwgMCkgewogICAgICAgIHRoaXMuZnVsbFBhdGhMaXN0LnB1c2gobmV3VmFsLmZ1bGxQYXRoKQogICAgICAgIHRoaXMucGFnZXMucHVzaChuZXdWYWwpCiAgICAgIH0KICAgIH0sCiAgICBhY3RpdmVLZXk6IGZ1bmN0aW9uIChuZXdQYXRoS2V5KSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogbmV3UGF0aEtleSB9KQogICAgfQogIH0sCiAgcmVuZGVyICgpIHsKICAgIGNvbnN0IHsgb25FZGl0LCAkZGF0YTogeyBwYWdlcyB9IH0gPSB0aGlzCiAgICBjb25zdCBwYW5lcyA9IHBhZ2VzLm1hcChwYWdlID0+IHsKICAgICAgcmV0dXJuICgKICAgICAgICA8YS10YWItcGFuZQogICAgICAgICAgc3R5bGU9e3sgaGVpZ2h0OiAwIH19CiAgICAgICAgICB0YWI9e3RoaXMucmVuZGVyVGFiUGFuZShwYWdlLm1ldGEuY3VzdG9tVGl0bGUgfHwgcGFnZS5tZXRhLnRpdGxlLCBwYWdlLmZ1bGxQYXRoKX0KICAgICAgICAgIGtleT17cGFnZS5mdWxsUGF0aH0gY2xvc2FibGU9e3BhZ2VzLmxlbmd0aCA+IDF9CiAgICAgICAgPgogICAgICAgIDwvYS10YWItcGFuZT4pCiAgICB9KQoKICAgIHJldHVybiAoCiAgICAgIDxkaXYgY2xhc3M9ImFudC1wcm8tbXVsdGktdGFiIj4KICAgICAgICA8ZGl2IGNsYXNzPSJhbnQtcHJvLW11bHRpLXRhYi13cmFwcGVyIj4KICAgICAgICAgIDxhLXRhYnMKICAgICAgICAgICAgaGlkZUFkZAogICAgICAgICAgICB0eXBlPXsnZWRpdGFibGUtY2FyZCd9CiAgICAgICAgICAgIHYtbW9kZWw9e3RoaXMuYWN0aXZlS2V5fQogICAgICAgICAgICB0YWJCYXJTdHlsZT17eyBiYWNrZ3JvdW5kOiAnI0ZGRicsIG1hcmdpbjogMCwgcGFkZGluZ0xlZnQ6ICcxNnB4JywgcGFkZGluZ1RvcDogJzFweCcgfX0KICAgICAgICAgICAgey4uLnsgb246IHsgZWRpdDogb25FZGl0IH0gfX0+CiAgICAgICAgICAgIHtwYW5lc30KICAgICAgICAgIDwvYS10YWJzPgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgICkKICB9Cn0K"},{"version":3,"sources":["MultiTab.vue"],"names":[],"mappings":";AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MultiTab.vue","sourceRoot":"src/components/MultiTab","sourcesContent":["<script>\nimport events from './events'\n\nexport default {\n  name: 'MultiTab',\n  data () {\n    return {\n      fullPathList: [],\n      pages: [],\n      activeKey: '',\n      newTabIndex: 0\n    }\n  },\n  created () {\n    // bind event\n    events.$on('open', val => {\n      if (!val) {\n        throw new Error(`multi-tab: open tab ${val} err`)\n      }\n      this.activeKey = val\n    }).$on('close', val => {\n      if (!val) {\n        this.closeThat(this.activeKey)\n        return\n      }\n      this.closeThat(val)\n    }).$on('rename', ({ key, name }) => {\n      console.log('rename', key, name)\n      try {\n        const item = this.pages.find(item => item.path === key)\n        item.meta.customTitle = name\n        this.$forceUpdate()\n      } catch (e) {\n      }\n    })\n\n    this.pages.push(this.$route)\n    this.fullPathList.push(this.$route.fullPath)\n    this.selectedLastPath()\n  },\n  methods: {\n    onEdit (targetKey, action) {\n      this[action](targetKey)\n    },\n    remove (targetKey) {\n      this.pages = this.pages.filter(page => page.fullPath !== targetKey)\n      this.fullPathList = this.fullPathList.filter(path => path !== targetKey)\n      // 判断当前标签是否关闭，若关闭则跳转到最后一个还存在的标签页\n      if (!this.fullPathList.includes(this.activeKey)) {\n        this.selectedLastPath()\n      }\n    },\n    selectedLastPath () {\n      this.activeKey = this.fullPathList[this.fullPathList.length - 1]\n    },\n\n    // content menu\n    closeThat (e) {\n      // 判断是否为最后一个标签页，如果是最后一个，则无法被关闭\n      if (this.fullPathList.length > 1) {\n        this.remove(e)\n      } else {\n        this.$message.info('这是最后一个标签了, 无法被关闭')\n      }\n    },\n    closeLeft (e) {\n      const currentIndex = this.fullPathList.indexOf(e)\n      if (currentIndex > 0) {\n        this.fullPathList.forEach((item, index) => {\n          if (index < currentIndex) {\n            this.remove(item)\n          }\n        })\n      } else {\n        this.$message.info('左侧没有标签')\n      }\n    },\n    closeRight (e) {\n      const currentIndex = this.fullPathList.indexOf(e)\n      if (currentIndex < (this.fullPathList.length - 1)) {\n        this.fullPathList.forEach((item, index) => {\n          if (index > currentIndex) {\n            this.remove(item)\n          }\n        })\n      } else {\n        this.$message.info('右侧没有标签')\n      }\n    },\n    closeAll (e) {\n      const currentIndex = this.fullPathList.indexOf(e)\n      this.fullPathList.forEach((item, index) => {\n        if (index !== currentIndex) {\n          this.remove(item)\n        }\n      })\n    },\n    closeMenuClick (key, route) {\n      this[key](route)\n    },\n    renderTabPaneMenu (e) {\n      return (\n        <a-menu {...{ on: { click: ({ key, item, domEvent }) => { this.closeMenuClick(key, e) } } }}>\n          <a-menu-item key=\"closeThat\">关闭当前标签</a-menu-item>\n          <a-menu-item key=\"closeRight\">关闭右侧</a-menu-item>\n          <a-menu-item key=\"closeLeft\">关闭左侧</a-menu-item>\n          <a-menu-item key=\"closeAll\">关闭全部</a-menu-item>\n        </a-menu>\n      )\n    },\n    // render\n    renderTabPane (title, keyPath) {\n      const menu = this.renderTabPaneMenu(keyPath)\n\n      return (\n        <a-dropdown overlay={menu} trigger={['contextmenu']}>\n          <span style={{ userSelect: 'none' }}>{ title }</span>\n        </a-dropdown>\n      )\n    }\n  },\n  watch: {\n    '$route': function (newVal) {\n      this.activeKey = newVal.fullPath\n      if (this.fullPathList.indexOf(newVal.fullPath) < 0) {\n        this.fullPathList.push(newVal.fullPath)\n        this.pages.push(newVal)\n      }\n    },\n    activeKey: function (newPathKey) {\n      this.$router.push({ path: newPathKey })\n    }\n  },\n  render () {\n    const { onEdit, $data: { pages } } = this\n    const panes = pages.map(page => {\n      return (\n        <a-tab-pane\n          style={{ height: 0 }}\n          tab={this.renderTabPane(page.meta.customTitle || page.meta.title, page.fullPath)}\n          key={page.fullPath} closable={pages.length > 1}\n        >\n        </a-tab-pane>)\n    })\n\n    return (\n      <div class=\"ant-pro-multi-tab\">\n        <div class=\"ant-pro-multi-tab-wrapper\">\n          <a-tabs\n            hideAdd\n            type={'editable-card'}\n            v-model={this.activeKey}\n            tabBarStyle={{ background: '#FFF', margin: 0, paddingLeft: '16px', paddingTop: '1px' }}\n            {...{ on: { edit: onEdit } }}>\n            {panes}\n          </a-tabs>\n        </div>\n      </div>\n    )\n  }\n}\n</script>\n"]}]}