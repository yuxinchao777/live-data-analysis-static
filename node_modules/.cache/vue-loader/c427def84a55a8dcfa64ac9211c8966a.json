{"remainingRequest":"/Users/momo/vue/live-data-analysis-static/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/momo/vue/live-data-analysis-static/src/views/qadata/qadate.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/momo/vue/live-data-analysis-static/src/views/qadata/qadate.vue","mtime":1631868260866},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/cache-loader/dist/cjs.js","mtime":1626939577620},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/babel-loader/lib/index.js","mtime":1626939577610},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/cache-loader/dist/cjs.js","mtime":1626939577620},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/vue-loader/lib/index.js","mtime":1626939590555}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JwppbXBvcnQgJ21vbWVudC9sb2NhbGUvemgtY24nCmltcG9ydCB7IGF4aW9zIH0gZnJvbSAnQC91dGlscy9yZXF1ZXN0JwoKY29uc3QgY29sdW1ucyA9IFsKICB7IHRpdGxlOiAn5aeT5ZCNJywgd2lkdGg6IDMwLCBkYXRhSW5kZXg6ICduYW1lJywga2V5OiAnbmFtZScgfSwKICB7IHRpdGxlOiAn5bel5pe277yISO+8iScsIHdpZHRoOiAzMCwgZGF0YUluZGV4OiAnam9iSG91cnMnLCBrZXk6ICd1c2VfdGltZScgfSwKICB7IHRpdGxlOiAnY2FzZeaVsCcsIHdpZHRoOiAzMCwgZGF0YUluZGV4OiAnY2FzZU51bScsIGtleTogJ2Nhc2VOdW0nIH0sCiAgeyB0aXRsZTogJ2J1Z+aVsCcsIHdpZHRoOiAzMCwgZGF0YUluZGV4OiAnYnVnTnVtJywga2V5OiAnYnVnTnVtJyB9LAogIHsKICAgIHRpdGxlOiAn6K+m5oOFJywKICAgIGtleTogJ3Rhc2tEZXRhaWwnLAogICAgd2lkdGg6IDI1MCwKICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogJ2FjdGlvbicgfSwKICB9LApdCgpjb25zdCBxYWRhdGFzID0gewogIHN0YXR1c2NvZGU6IDIwMCwKICBkYXRhOiB7CiAgICBhcGFydG1lbnRzOiBbeyBpZDogMSwgbmFtZTogJ+WVhuS4mlFBJyB9XSwKICB9LAp9CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNvbHVtbnMsCiAgICAgIHFhZGF0YXMsCiAgICAgIHFhZGF0YTogW10sCiAgICAgIGRhdGVSYW5nZTogW10sCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICBhcGFydG1lbnRpZDogMCwKICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBpbml0KCkgewogICAgICAvL+WRqOS4gCDlkajml6UKICAgICAgY29uc3QgbW9uZGF5ID0gdGhpcy5kYXlqcygpLnN0YXJ0T2YoJ3dlZWsnKS5hZGQoMSwgJ2RheScpCiAgICAgIGNvbnN0IHN1bmRheSA9IHRoaXMuZGF5anMoKS5lbmRPZignd2VlaycpLmFkZCgxLCAnZGF5JykKCiAgICAgIC8v5pe26Ze06L2sbW9tZW505a+56LGhCiAgICAgIHRoaXMuZGF0ZVJhbmdlID0gWwogICAgICAgIG1vbWVudChtb25kYXkuZm9ybWF0KCdkZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzIFpaJykpLAogICAgICAgIG1vbWVudChzdW5kYXkuZm9ybWF0KCdkZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzIFpaJykpLAogICAgICBdCgogICAgICBsZXQgdGVtcHRpbWUgPSBbbW9uZGF5LmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpLCBzdW5kYXkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyldCiAgICAgIHRoaXMuZ2V0cWFkYXRlKHRlbXB0aW1lWzBdLCB0ZW1wdGltZVsxXSkKICAgIH0sCiAgICBnZXRxYWRhdGUoc3RhcnR0aW1lLCBlbmR0aW1lKSB7CiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZQogICAgICBheGlvcwogICAgICAgIC5wb3N0KCcvcWFTdGF0aXN0aWNzJywgewogICAgICAgICAgc3RhcnRUaW1lOiBzdGFydHRpbWUsCiAgICAgICAgICBlbmRUaW1lOiBlbmR0aW1lLAogICAgICAgICAgYXBhcnRtZW50aWQ6IHRoaXMuYXBhcnRtZW50aWQsCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICByZXNwb25zZS5kYXRhLmZvckVhY2goaXRlbT0+e2l0ZW0uam9iSG91cnMgPSBpdGVtLmpvYkhvdXJzLnRvRml4ZWQoMil9KQogICAgICAgICAgICB0aGlzLnFhZGF0YSA9IHJlc3BvbnNlLmRhdGEKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2UKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WGhee9keaVsOaNruiOt+WPluWksei0pScpCiAgICAgICAgfSkKICAgIH0sCiAgICBzZXRhcGFydG1lbnRpZChhcGFydG1lbnRpZCkgewogICAgICB0aGlzLmFwYXJ0bWVudGlkID0gYXBhcnRtZW50aWQKICAgIH0sCiAgICBnZXRuZWVkdGltZWxpc3QoZGF0ZVJhbmdlKSB7CiAgICAgIGlmIChkYXRlUmFuZ2UubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKCfml7bpl7TkuI3og73kuLrnqbonKQogICAgICB9CgogICAgICBsZXQgY3VycmVudFN0YXJ0VGltZSA9IHRoaXMuZGF5anMoZGF0ZVJhbmdlWzBdLnZhbHVlT2YoKSkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJykKICAgICAgbGV0IGN1cnJlbnRFbmRUaW1lID0gdGhpcy5kYXlqcyhkYXRlUmFuZ2VbMV0udmFsdWVPZigpKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKQogICAgICB0aGlzLmdldHFhZGF0ZShjdXJyZW50U3RhcnRUaW1lLCBjdXJyZW50RW5kVGltZSkKICAgIH0sCiAgICBqdW1wdG8oaHJlZmhvc3QpIHsKICAgICAgd2luZG93Lm9wZW4oaHJlZmhvc3QpCiAgICB9LAogICAgZ2V0Y3VycmVudHRpbWUocmFuZ2V0aW1lKSB7CiAgICAgIGNvbnN0IHN0YXJ0dGltZSA9IHRoaXMuZGF5anMocmFuZ2V0aW1lWzBdKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKQogICAgICBjb25zdCBlbmR0aW1lID0gdGhpcy5kYXlqcyhyYW5nZXRpbWVbMV0pLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpCiAgICAgIHJldHVybiBbc3RhcnR0aW1lLCBlbmR0aW1lXQogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7fSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0KCkKICB9LAp9Cg=="},{"version":3,"sources":["qadate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"qadate.vue","sourceRoot":"src/views/qadata","sourcesContent":["<template>\n  <div>\n    <div>\n      <!--部门下拉框-->\n      部门<a-select default-value=\"商业QA\" style=\"width: 100px; margin-left: 5px\">\n        <a-select-option\n          v-for=\"apartment in qadatas.data.apartments\"\n          :key=\"apartment.id\"\n          :value=\"apartment.name\"\n          @click=\"setapartmentid(apartment.id)\"\n        >\n          {{ apartment.name }}\n        </a-select-option>\n      </a-select>\n      <!--时间选择框-->\n      <a-range-picker class=\"a-range-picker\" style=\"width: 400px\" show-time v-model=\"dateRange\">\n        <template slot=\"renderExtraFooter\"> 日期选择</template>\n      </a-range-picker>\n      <!--查询按钮-->\n      <a-button type=\"primary\" icon=\"search\" @click=\"getneedtimelist(dateRange)\"> 查询 </a-button>\n    </div>\n\n    <!--表格-->\n    <a-table\n      :columns=\"columns\"\n      :data-source=\"qadata\"\n      style=\"margin-top: 20px;\"\n      :loading=\"isLoading\"\n      :pagination=\"{ defaultPageSize: 100 }\"\n    >\n      <div slot=\"action\" slot-scope=\"text, record\">\n        <!--        {{record.details}}-->\n        <div v-if=\"record.taskDetail && record.taskDetail.length\">\n          <a v-for=\"(detail, index) in record.taskDetail\" :key=\"index\" @click=\"jumpto(detail && detail.taskUrl)\">\n            <span class=\"record-text\" style=\"margin-top: 20px; margin-bottom: 20px\">\n              <span style=\"color: rgb(0, 209, 178)\">[{{ detail.jobHours }}H]</span>\n              <span>{{ detail.taskName }}</span>\n            </span>\n          </a>\n        </div>\n        <div v-else>\n          <a>无</a>\n        </div>\n      </div>\n    </a-table>\n  </div>\n</template>\n\n<script>\nimport moment from 'moment'\nimport 'moment/locale/zh-cn'\nimport { axios } from '@/utils/request'\n\nconst columns = [\n  { title: '姓名', width: 30, dataIndex: 'name', key: 'name' },\n  { title: '工时（H）', width: 30, dataIndex: 'jobHours', key: 'use_time' },\n  { title: 'case数', width: 30, dataIndex: 'caseNum', key: 'caseNum' },\n  { title: 'bug数', width: 30, dataIndex: 'bugNum', key: 'bugNum' },\n  {\n    title: '详情',\n    key: 'taskDetail',\n    width: 250,\n    scopedSlots: { customRender: 'action' },\n  },\n]\n\nconst qadatas = {\n  statuscode: 200,\n  data: {\n    apartments: [{ id: 1, name: '商业QA' }],\n  },\n}\n\nexport default {\n  data() {\n    return {\n      columns,\n      qadatas,\n      qadata: [],\n      dateRange: [],\n      visible: false,\n      apartmentid: 0,\n      isLoading: false,\n    }\n  },\n\n  methods: {\n    init() {\n      //周一 周日\n      const monday = this.dayjs().startOf('week').add(1, 'day')\n      const sunday = this.dayjs().endOf('week').add(1, 'day')\n\n      //时间转moment对象\n      this.dateRange = [\n        moment(monday.format('dddd MMM DD YYYY HH:mm:ss ZZ')),\n        moment(sunday.format('dddd MMM DD YYYY HH:mm:ss ZZ')),\n      ]\n\n      let temptime = [monday.format('YYYY-MM-DD HH:mm:ss'), sunday.format('YYYY-MM-DD HH:mm:ss')]\n      this.getqadate(temptime[0], temptime[1])\n    },\n    getqadate(starttime, endtime) {\n      this.isLoading = true\n      axios\n        .post('/qaStatistics', {\n          startTime: starttime,\n          endTime: endtime,\n          apartmentid: this.apartmentid,\n        })\n        .then((response) => {\n          if (response.code === 200) {\n            this.isLoading = false\n            response.data.forEach(item=>{item.jobHours = item.jobHours.toFixed(2)})\n            this.qadata = response.data\n          }\n        })\n        .catch((error) => {\n          this.isLoading = false\n          this.$message.error('内网数据获取失败')\n        })\n    },\n    setapartmentid(apartmentid) {\n      this.apartmentid = apartmentid\n    },\n    getneedtimelist(dateRange) {\n      if (dateRange.length === 0) {\n        this.$message.info('时间不能为空')\n      }\n\n      let currentStartTime = this.dayjs(dateRange[0].valueOf()).format('YYYY-MM-DD HH:mm:ss')\n      let currentEndTime = this.dayjs(dateRange[1].valueOf()).format('YYYY-MM-DD HH:mm:ss')\n      this.getqadate(currentStartTime, currentEndTime)\n    },\n    jumpto(hrefhost) {\n      window.open(hrefhost)\n    },\n    getcurrenttime(rangetime) {\n      const starttime = this.dayjs(rangetime[0]).format('YYYY-MM-DD HH:mm:ss')\n      const endtime = this.dayjs(rangetime[1]).format('YYYY-MM-DD HH:mm:ss')\n      return [starttime, endtime]\n    },\n  },\n  computed: {},\n  created() {\n    this.init()\n  },\n}\n</script>\n\n<style scoped>\n.a-range-picker {\n  margin-left: 20px;\n  margin-right: 20px;\n}\n\na {\n  display: inline-block;\n  height: 22px;\n  line-height: 22px;\n}\n\na:hover {\n  /* text-decoration: underline; */\n  border-bottom: 1px solid #409EFF;\n}\n</style>"]}]}