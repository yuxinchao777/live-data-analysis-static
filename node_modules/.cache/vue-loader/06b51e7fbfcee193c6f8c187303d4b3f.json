{"remainingRequest":"/Users/momo/vue/live-data-analysis-static/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/momo/vue/live-data-analysis-static/src/views/dashboard/ProjectDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/momo/vue/live-data-analysis-static/src/views/dashboard/ProjectDetail.vue","mtime":1626864386285},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/momo/vue/live-data-analysis-static/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGF4aW9zIH0gZnJvbSAnQC91dGlscy9yZXF1ZXN0JwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnCmltcG9ydCBWdWUgZnJvbSAndnVlJwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHt9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzaG93UGFnaW5hdGlvbjogZmFsc2UsCiAgICAgIGxvYWRpbmdEZXRhaWw6IGZhbHNlLAogICAgICBwcm9qZWN0TmFtZTogdGhpcy4kcm91dGUucXVlcnkucHJvamVjdE5hbWUsCiAgICAgIGV4cGFuZGVkUm93S2V5czogW10sCiAgICAgIHByb2plY3RDb2x1bW5zOiBbCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfluo/lj7cnLAogICAgICAgICAgZGF0YUluZGV4OiAnaW5kZXgnLAogICAgICAgICAga2V5OiAnaW5kZXgnLAogICAgICAgICAgd2lkdGg6IDkwLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfpnIDmsYLlkI3np7AnLAogICAgICAgICAgZGF0YUluZGV4OiAnZnVuY3Rpb25OYW1lJywKICAgICAgICAgIGtleTogJ2Z1bmN0aW9uTmFtZScsCiAgICAgICAgICB3aWR0aDogNDAwLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfpnIDmsYLnrYnnuqcnLAogICAgICAgICAgZGF0YUluZGV4OiAnZnVuY3Rpb25fbGV2ZWwnLAogICAgICAgICAga2V5OiAnZnVuY3Rpb25fbGV2ZWwnLAogICAgICAgICAgYWxpZ246ICdjZW50ZXInLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICflvIDlj5Hkurrml6UnLAogICAgICAgICAga2V5OiAncmRKb2JEYXlzJywKICAgICAgICAgIGFsaWduOiAncmlnaHQnLAogICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAncmRKb2JEYXlzJyB9LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfmtYvor5Xkurrml6UnLAogICAgICAgICAga2V5OiAncWFKb2JEYXlzJywKICAgICAgICAgIGFsaWduOiAncmlnaHQnLAogICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAncWFKb2JEYXlzJyB9LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICflvIDlj5HmtYvor5Xkurrml6Xmr5QnLAogICAgICAgICAgZGF0YUluZGV4OiAnTWFuRGF5UmF0aW8nLAogICAgICAgICAga2V5OiAnTWFuRGF5UmF0aW8nLAogICAgICAgICAgYWxpZ246ICdjZW50ZXInLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfmmK/lkKblu7bmnJ/mj5DmtYsnLAogICAgICAgICAga2V5OiAnZGVsYXknLAogICAgICAgICAgYWxpZ246ICdjZW50ZXInLAogICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAnZGVsYXllZCcgfSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAn5YaS54Of57uT5p6cJywKICAgICAgICAgIGRhdGFJbmRleDogJ3Ntb2tpbmcnLAogICAgICAgICAga2V5OiAnc21va2luZycsCiAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgZGV0YWlsQ2FjaGU6IHt9LAogICAgICBsb2FkUHJvamVjdERhdGE6IFtdLAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5pdCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0KCkgewogICAgICBheGlvcwogICAgICAgIC5wb3N0KCcvQnVzaW5lc3NDb250cm9sbGVyL2dldEZ1bmN0aW9uRGV0YWlscycsIHsKICAgICAgICAgIHN0aW1lOiB0aGlzLiRyb3V0ZS5xdWVyeS5zdGltZSwKICAgICAgICAgIGV0aW1lOiB0aGlzLiRyb3V0ZS5xdWVyeS5ldGltZSwKICAgICAgICAgIHByb2plY3RJZDogdGhpcy4kcm91dGUucXVlcnkucHJvamVjdElkLAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YVswXS5saXN0CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZGF0YVtpXS5pbmRleCA9IGkgKyAxCiAgICAgICAgICAgIGlmICghKCdmdW5jdGlvbl9sZXZlbCcgaW4gZGF0YVtpXSkgfHwgXy5pc0VtcHR5KGRhdGFbaV0uZnVuY3Rpb25fbGV2ZWwpKSB7CiAgICAgICAgICAgICAgZGF0YVtpXS5mdW5jdGlvbl9sZXZlbCA9ICctJwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghKCdzbW9raW5nJyBpbiBkYXRhW2ldKSkgewogICAgICAgICAgICAgIGRhdGFbaV0uc21va2luZyA9ICctJwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRhdGFbaV0uZGV0YWlsID0gW3sgcmF3OiAn5Yqg6L295LitJyB9XQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5sb2FkUHJvamVjdERhdGEgPSBkYXRhCiAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAxMCkgewogICAgICAgICAgICB0aGlzLnNob3dQYWdpbmF0aW9uID0gdHJ1ZQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgICAgfSkKICAgIH0sCiAgICBleHBhbmQoZXhwYW5kZWQsIHJlY29yZCkgewogICAgICBjb25zb2xlLmxvZygnZXhwYW5kICcsIGV4cGFuZGVkLCByZWNvcmQpCiAgICAgIGlmIChleHBhbmRlZCkgewogICAgICAgIHRoaXMuZXhwYW5kZWRSb3dLZXlzID0gW3JlY29yZC5pbmRleF0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmV4cGFuZGVkUm93S2V5cyA9IFtdCiAgICAgIH0KICAgICAgdGhpcy5nZXRSb3dEZXRhaWwocmVjb3JkKQogICAgfSwKICAgIGdldFJvd0RldGFpbChyZWNvcmQpIHsKICAgICAgaWYgKCEocmVjb3JkLmluZGV4IGluIHRoaXMuZGV0YWlsQ2FjaGUpKSB7CiAgICAgICAgdGhpcy5nZXRRYURhaWx5KHJlY29yZCkKICAgICAgfQogICAgfSwKICAgIGdldFFhRGFpbHkocmVjb3JkKSB7CiAgICAgIHRoaXMubG9hZGluZ0RldGFpbCA9IHRydWUKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCcvQnVzaW5lc3NDb250cm9sbGVyL2dldFFhRGFpbHk/ZnVuY3Rpb25JZD0nICsgcmVjb3JkLmZ1bmN0aW9uSWQpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YS5sZW5ndGggPiAwID8gcmVzLmRhdGEgOiBbeyByYXc6ICfmmoLml6DmtYvor5Xov5vluqbmlbDmja4nIH1dCiAgICAgICAgICBWdWUuc2V0KHRoaXMuZGV0YWlsQ2FjaGUsIHJlY29yZC5pbmRleCwgZGF0YSkKICAgICAgICAgIHRoaXMubG9hZFByb2plY3REYXRhW3JlY29yZC5pbmRleF0uZGV0YWlsID0gZGF0YQogICAgICAgICAgdGhpcy5sb2FkaW5nRGV0YWlsID0gZmFsc2UKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgICAgdGhpcy5sb2FkaW5nRGV0YWlsID0gZmFsc2UKICAgICAgICB9KQogICAgfSwKICAgIGdldEZpeGVkTnVtYmVyKGRheSkgewogICAgICByZXR1cm4gTWF0aC5yb3VuZChOdW1iZXIoZGF5KSAqIDEwMCkgLyAxMDAKICAgIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgdGl0bGUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5tZXRhLnRpdGxlCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["ProjectDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProjectDetail.vue","sourceRoot":"src/views/dashboard","sourcesContent":["<template>\n  <div>\n    <div class=\"ant-title\">{{ projectName }}详细数据</div>\n    <a-table\n      :pagination=\"showPagination\"\n      row-key=\"index\"\n      :columns=\"projectColumns\"\n      :data-source=\"loadProjectData\"\n      @expand=\"expand\"\n      :expandedRowKeys=\"expandedRowKeys\"\n    >\n      <template slot=\"delayed\" slot-scope=\"record\">\n        <span :class=\"record.delay == '正常' ? 'normalColumn' : 'warningColumn'\">\n          {{ record.delay }}\n        </span>\n      </template>\n      <template slot=\"rdJobDays\" slot-scope=\"record\">\n        <span>\n          {{ getFixedNumber(record.rdJobDays) }}\n        </span>\n      </template>\n      <template slot=\"qaJobDays\" slot-scope=\"record\">\n        <span>\n          {{ getFixedNumber(record.qaJobDays) }}\n        </span>\n      </template>\n      <div slot=\"expandedRowRender\" slot-scope=\"record\" style=\"margin: 0\">\n        <div v-if=\"'date' in loadProjectData[record.index].detail[0]\">\n          <a-tabs :default-active-key=\"0\" tab-position=\"left\" style=\"margin-left: -48px\">\n            <a-tab-pane v-for=\"(detail, index) in loadProjectData[record.index].detail\" :key=\"index\" :tab=\"detail.date\"\n              ><a-row>\n                <div v-html=\"detail.raw\" style=\"width: 100%\"></div>\n              </a-row>\n            </a-tab-pane>\n          </a-tabs>\n        </div>\n        <div v-else><span v-html=\"loadProjectData[record.index].detail[0].raw\"></span></div>\n      </div>\n    </a-table>\n  </div>\n</template>\n\n<script>\nimport { axios } from '@/utils/request'\nimport _ from 'lodash'\nimport Vue from 'vue'\n\nexport default {\n  components: {},\n  data() {\n    return {\n      showPagination: false,\n      loadingDetail: false,\n      projectName: this.$route.query.projectName,\n      expandedRowKeys: [],\n      projectColumns: [\n        {\n          title: '序号',\n          dataIndex: 'index',\n          key: 'index',\n          width: 90,\n        },\n        {\n          title: '需求名称',\n          dataIndex: 'functionName',\n          key: 'functionName',\n          width: 400,\n        },\n        {\n          title: '需求等级',\n          dataIndex: 'function_level',\n          key: 'function_level',\n          align: 'center',\n        },\n        {\n          title: '开发人日',\n          key: 'rdJobDays',\n          align: 'right',\n          scopedSlots: { customRender: 'rdJobDays' },\n        },\n        {\n          title: '测试人日',\n          key: 'qaJobDays',\n          align: 'right',\n          scopedSlots: { customRender: 'qaJobDays' },\n        },\n        {\n          title: '开发测试人日比',\n          dataIndex: 'ManDayRatio',\n          key: 'ManDayRatio',\n          align: 'center',\n        },\n        {\n          title: '是否延期提测',\n          key: 'delay',\n          align: 'center',\n          scopedSlots: { customRender: 'delayed' },\n        },\n        {\n          title: '冒烟结果',\n          dataIndex: 'smoking',\n          key: 'smoking',\n          align: 'center',\n        },\n      ],\n      detailCache: {},\n      loadProjectData: [],\n    }\n  },\n  created() {\n    this.init()\n  },\n  methods: {\n    init() {\n      axios\n        .post('/BusinessController/getFunctionDetails', {\n          stime: this.$route.query.stime,\n          etime: this.$route.query.etime,\n          projectId: this.$route.query.projectId,\n        })\n        .then((res) => {\n          let data = res.data[0].list\n          for (let i = 0; i < data.length; i++) {\n            data[i].index = i + 1\n            if (!('function_level' in data[i]) || _.isEmpty(data[i].function_level)) {\n              data[i].function_level = '-'\n            }\n            if (!('smoking' in data[i])) {\n              data[i].smoking = '-'\n            }\n            data[i].detail = [{ raw: '加载中' }]\n          }\n          this.loadProjectData = data\n          if (data.length > 10) {\n            this.showPagination = true\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    expand(expanded, record) {\n      console.log('expand ', expanded, record)\n      if (expanded) {\n        this.expandedRowKeys = [record.index]\n      } else {\n        this.expandedRowKeys = []\n      }\n      this.getRowDetail(record)\n    },\n    getRowDetail(record) {\n      if (!(record.index in this.detailCache)) {\n        this.getQaDaily(record)\n      }\n    },\n    getQaDaily(record) {\n      this.loadingDetail = true\n      axios\n        .get('/BusinessController/getQaDaily?functionId=' + record.functionId)\n        .then((res) => {\n          let data = res.data.length > 0 ? res.data : [{ raw: '暂无测试进度数据' }]\n          Vue.set(this.detailCache, record.index, data)\n          this.loadProjectData[record.index].detail = data\n          this.loadingDetail = false\n        })\n        .catch(function (error) {\n          console.log(error)\n          this.loadingDetail = false\n        })\n    },\n    getFixedNumber(day) {\n      return Math.round(Number(day) * 100) / 100\n    },\n  },\n  computed: {\n    title() {\n      return this.$route.meta.title\n    },\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n.extra-wrapper {\n  line-height: 55px;\n  padding-right: 24px;\n\n  .extra-item {\n    display: inline-block;\n    margin-right: 24px;\n\n    a {\n      margin-left: 24px;\n    }\n  }\n}\n\n.antd-pro-pages-dashboard-analysis-twoColLayout {\n  position: relative;\n  display: flex;\n  display: block;\n  flex-flow: row wrap;\n}\n\n.antd-pro-pages-dashboard-analysis-salesCard {\n  width: 100%;\n  height: calc(100% - 24px);\n  /* /deep/ .ant-card-head {\n    position: relative;\n  } */\n}\n\n.ant-col-3 {\n  width: 33%;\n}\n\n.ant-font-2 {\n  font-size: 13px;\n}\n.dashboard-analysis-iconGroup {\n  i {\n    margin-left: 16px;\n    color: rgba(0, 0, 0, 0.45);\n    cursor: pointer;\n    transition: color 0.32s;\n    color: black;\n  }\n}\n.analysis-salesTypeRadio {\n  position: absolute;\n  right: 54px;\n  bottom: 12px;\n}\n\n.timeRadioGroup {\n  margin-left: 54px;\n}\n\n.timeRadioButtons.ant-radio-button-wrapper::before {\n  display: none;\n  visibility: hidden;\n}\n.timeRadioButtons {\n  border: none;\n}\n.timeRadioGroup {\n  margin-left: 54px;\n  border: none;\n}\n.ant-radio-button-wrapper-checked:not(.ant-radio-button-wrapper-disabled) {\n  z-index: 1;\n  color: #1890ff;\n  background: #fff;\n  border-color: #ffffff;\n  -webkit-box-shadow: -1px 0 0 0 #ffffff;\n  box-shadow: -1px 0 0 0 #ffffff;\n}\n.ant-title {\n  color: #1890ff;\n  font-size: 16px;\n  margin-bottom: 24px;\n  font-weight: 500;\n}\n.warningColumn {\n  color: #ef3c59;\n  font-weight: bold;\n  padding: 5px;\n}\n</style>\n"]}]}